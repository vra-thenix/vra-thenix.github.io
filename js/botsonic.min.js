!function(){"use strict";var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{DEFAULT_NAME:function(){return $},default:function(){return ee}});var n={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.r(n),e.d(n,{CHANGE_BOT_AVATAR_EVENT:function(){return y},CHANGE_BUTTON_ICON_EVENT:function(){return m},CHANGE_CHATBOT_SUBHEADING_EVENT:function(){return b},CHANGE_COLOR_EVENT:function(){return d},CHANGE_COMPANY_LOGO_EVENT:function(){return p},CHANGE_COMPANY_NAME_EVENT:function(){return f},CHANGE_CUSTOM_PLACEHOLDER_EVENT:function(){return E},CHANGE_NO_SOURCES_ADDED_MESSAGE_EVENT:function(){return _},CHANGE_SERVER_ERROR_MESSAGE_EVENT:function(){return N},CHANGE_SHOW_BRAND_EVENT:function(){return h},CHANGE_SHOW_FLOATING_STARTER_QUESTIONS:function(){return C},CHANGE_SHOW_FLOATING_WELCOME_MESSAGE_EVENT:function(){return T},CHANGE_SHOW_SOURCES:function(){return A},CHANGE_STARTER_QUESTIONS_EVENT:function(){return v},CHANGE_USER_FORM_VISIBILITY:function(){return S},CHANGE_WELCOME_MESSAGE:function(){return g},CREATE_CONVERSATION_ID:function(){return O},INTERNAL_PORTAL_EVENT:function(){return j},UPDATE_USER_FORM:function(){return w}});var d="Botsonic:changeColor",f="Botsonic:changeCompanyName",p="Botsonic:changeCompanyLogo",y="Botsonic:changeBotAvatar",g="Botsonic: changeWelcomeMessage",v="ws:changeStarterQuestionsEvent",h="Botsonic:changeShowBrand",m="Botsonic:changeButtonIcon",b="Botsonic:changeChatBotSubheading",w="Botsonic:updateUserForm",E="Botsonic:changeCustomPlaceholderEvent",S="Botsonic:changeUserFormVisibility",O="Botsonic:createConversationID",A="Botsonic:changeShowSources",N="Botsonic:changeServerErrorMessageEvent",_="Botsonic:changeNoSourcesAddedMessageEvent",T="Botsonic:changeShowFloatingWelcomeMessageEvent",C="Botsonic:changeShowFloatingStarterQuestions",j="Botsonic:internalPortalEvent",H="https://d2nnr6irhfmb65.cloudfront.net",B=[],W={addedHeight:0},I=new Set(["localhost","staging.writesonic.com"]),R=function(){var e;I.has(window.location.hostname)&&(e=console).error.apply(e,arguments)},M=function(e){e.style.maxWidth=W.addedHeight?"320px":"75px",e.style.maxHeight="".concat(75+W.addedHeight,"px")},G=function(){return window.innerWidth>450?"704px":"100%"},P=function(e,t){var n=e.outerWrapper;n&&(t?(n.style.maxWidth="452px",n.style.maxHeight=G()):M(n))},L=function(e,t){W.addedHeight=t;var n=e.outerWrapper;n&&"number"==typeof t&&M(n)},x=function(e){var t=window.dataLayer;if(Array.isArray(t)){if("string"!=typeof e)return R("Analytics event parameters should be a string");var n=D(e);if(!n.success)return R(n.err);try{var r=n.parsedJson;t.push(r)}catch(e){}}},U=function(e,t){var n=e.outerWrapper;if(n){if("left"!==t)return console.error("Only left position change is supported");n.style.left="0",n.style.right="unset"}},V=function(){var e,t=c(B);try{for(t.s();!(e=t.n()).done;){var n=a(e.value,2),r=n[0],o=n[1];window.removeEventListener(r,o)}}catch(e){t.e(e)}finally{t.f()}B.length=0},D=function(e){try{return{success:!0,parsedJson:JSON.parse(String(e))}}catch(e){return{success:!1,err:e}}},F=function(e){var t="data"in e&&"string"==typeof e.data&&e.data,n="origin"in e&&"string"==typeof e.origin&&e.origin;if(!t||!n)return null;if(!n.includes(H))return null;var r=D(t);return r.success?r.parsedJson:(R(e),R(r.err),null)},J=function(e,t,n,r){var o;null===(o=e.contentWindow)||void 0===o||o.postMessage(JSON.stringify(l({message:"botsonic-event",instanceName:n},r)),t)},q=function(e,t,n){var r=e.iframeElement;if(r){var o=function(){return J(r,t,n,{type:"parent-window-resize",detailType:"object",detail:{innerWidth:window.innerWidth,innerHeight:window.innerHeight}})};window.addEventListener("resize",o),B.push(["resize",o]);var i={paused:!1},a=function e(o){var a,c,s,u,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.paused||(J(r,t,n,{type:"parent-window-scroll",detailType:"object",detail:{scrollPercentage:(a=window.innerHeight,c=window.scrollY,s=document.body.offsetHeight-a,u=c,s?Math.round(u/s*100):0)}}),l||(i.paused=!0,setTimeout((function(){i.paused=!1,e(null,!0)}),100)))};window.addEventListener("scroll",a),B.push(["scroll",a])}},z=function(e){return!!e&&"object"===r(e)&&"message"in e&&"string"==typeof e.message&&"instanceName"in e&&"string"==typeof e.instanceName},k=/^(http|https):\/\/((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)\.?\b){4}/,Q=function(e){return k.test(e)?e.replaceAll(".","-"):e.replace("localhost","local-host")},Y=function(e,t,n,r){var o=null,i=Object.assign(t,r);i.debug&&console.warn("Starting widget [".concat(n,"]"));var a=null;try{var c;a=null!==(c=e.parent.document.querySelector("#botsonic-widget-preview"))&&void 0!==c?c:null}catch(e){}var s=function(e,t,n){var r="".concat(H,"/CDN/index.html"),o=new URLSearchParams({"service-base-url":Q(t.serviceBaseUrl),token:t.token,"base-origin":Q(t.baseOrigin),"instance-name":Q(n)}),i=e.document.createElement("iframe");return i.setAttribute("id","widget-".concat(n)),i.setAttribute("title","Widget - ".concat(n)),i.setAttribute("allow","fullscreen"),i.setAttribute("allowtransparency","true"),i.setAttribute("role","dialog"),i.setAttribute("src","".concat(r,"?").concat(o)),i.style.width="100%",i.style.height="100%",i.style.border="none",i}(e,t,n),u=function(e,t){var n=e.document.createElement("div");return n.setAttribute("id","".concat(t,"-wrapper")),n.style.width="100%",n.style.maxWidth="452px",n.style.height="100%",n.style.maxHeight=G(),n.style.minHeight="80px",n.style.position="fixed",n.style.bottom="0",n.style.right="0",n.style.zIndex="2147480000",n}(e,n);if(a){var l;u.style.maxHeight=G(),u.append(s),a.append(u),o=null===(l=s.contentWindow)||void 0===l?void 0:l.document.body}else{var d,f,p,y=null!==(d=i.element)&&void 0!==d?d:e.document.body;s.style.maxWidth="none",s.style.maxHeight="none",u.append(s),y.append(u),o=null!==(f=a)&&void 0!==f?f:null===(p=s.contentWindow)||void 0===p?void 0:p.document.body}if(!o)throw new Error("Configure is wrong");return e["botsonicConfig-".concat(n)]=i,e["loaded-".concat(n)]=!0,{iframeElement:s,outerWrapper:u}},$="Botsonic",K=Object.values(l({},n)),X=new URL(H).origin,Z={};function ee(e,t,n){var s,u;V();var d,f=null!==(s=null==n||null===(u=n.attributes.getNamedItem("id"))||void 0===u?void 0:u.value)&&void 0!==s?s:$,p=e[f];if(!p)throw new Error("Widget didn't find LoaderObject for instance [".concat(f,"]. ")+"The loading script was either modified, no call to 'init' method was done "+"or there is conflicting object defined in `window.".concat(f,"` ."));if(e["loaded-".concat(f)]){var y,g=e.document.querySelector("#".concat(f,"-wrapper")),v=(d=e.document.querySelectorAll("script"),function(e){if(Array.isArray(e))return o(e)}(d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(d)||i(d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).filter((function(e){var t;return"Botsonic"===(null===(t=e.attributes.getNamedItem("id"))||void 0===t?void 0:t.value)})),h=c(v.entries());try{for(h.s();!(y=h.n()).done;){var m=a(y.value,2),b=m[0],w=m[1];b&&w.remove()}}catch(e){h.e(e)}finally{h.f()}null==g||g.remove(),p.q=[],p.q.push(["init",e["botsonicConfig-".concat(f)]])}for(var E=0;E<(null==p||null===(S=p.q)||void 0===S?void 0:S.length);E++){var S,O=a(null==p?void 0:p.q[E],2),A=O[0],N=O[1];if(0===E&&"init"!==A)throw new Error("Failed to start Widget [".concat(f,"]. 'init' must be called before other methods."));0!==E&&"init"===A||("init"===A?Object.assign(Z,Y(e,l(l({},t),{},{isIframe:!1}),f,N)):console.warn("Unsupported loader method [".concat(A,"]"),N))}var _=function(t){if(t instanceof MessageEvent){var n=F(t);if(n){if(!z(n))return R("parsedData is not valid"),void R(t);if(n.instanceName===f)switch("localhost:3032"===window.location.host&&console.log("Loader message received",n.message,n.value),n.message){case"widget-expanded":return P(Z,Boolean(n.value));case"widget-position":return U(Z,String(n.value));case"add-collapsed-height":return L(Z,Number(n.value));case"analytics":return x(n.value);case"widget-ready":if(!T)return;var o=[T,X,f],i=e["botsonicConfig-".concat(f)]||{},a=i.user,c=i.actions;return a&&"object"===r(a)&&J.apply(void 0,o.concat([{type:"current-user-form-data",detailType:"object",detail:a}])),c&&"object"===r(c)&&J.apply(void 0,o.concat([{type:"schedule-actions",detailType:"object",detail:{actions:c}}])),J.apply(void 0,o.concat([{type:"parent-window-resize",detailType:"object",detail:{innerWidth:window.innerWidth,innerHeight:window.innerHeight}}]));case"get-parent-url":if(!T)return;return J(T,X,f,{type:"parent-url",detailType:"string",detail:window.location.href})}}}};window.addEventListener("message",_),B.push(["message",_]),q(Z,X,f);var T=Z.iframeElement;if(T){var C,j=function(e){return function(t){var n,o="detail"in t?t.detail:"error",i=r(o);null==T||null===(n=T.contentWindow)||void 0===n||n.postMessage(JSON.stringify({message:"botsonic-event",type:e,detailType:i,detail:"string"==typeof i?o:JSON.stringify(o),instanceName:f}),X)}},H=c(K);try{for(H.s();!(C=H.n()).done;){var W=C.value,I=j(W);window.addEventListener(W,I),B.push([W,I])}}catch(e){H.e(e)}finally{H.f()}}e[f]=function(n,o){var i=Z.iframeElement;switch(n){case"init":return console.warn("Reinitializing widget"),e["botsonicConfig-".concat(f)]=l(l({},e["botsonicConfig-".concat(f)]),o),ee(e,l(l(l({},t),o),{},{baseOrigin:window.origin}),e.document.currentScript);case"show":case"hide":case"open":case"close":var a;return null==i||null===(a=i.contentWindow)||void 0===a?void 0:a.postMessage(JSON.stringify({message:n,instanceName:f}),X);case"update":return o&&"actions"in o&&"object"===r(o.actions)?i&&J(i,X,f,{type:"schedule-actions",detailType:"object",detail:{actions:o.actions}}):void 0;default:console.warn("Unsupported widget method [".concat(n,"]"),o)}}}ee(window,{debug:!0,serviceBaseUrl:"",token:"",baseOrigin:window.origin,instanceName:""},window.document.currentScript),window.main=t}();